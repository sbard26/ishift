<!DOCTYPE html>
<html>
    <head>
        <title>Home - iShift</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <link href="css/bootstrap.css" type="text/css" rel="stylesheet"/>
        <link href="css/jquery-ui.css" type="text/css" rel="stylesheet"/>
        <link href="css/styles.css" type="text/css" rel="stylesheet"/>
        <script src="js/jquery-1.12.3.js"></script>
        <script src="js/jquery-ui.js"></script>
        <script src="js/bootstrap.js"></script>
        <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    </head>
    <body>
        <div class = "col-md-2" style = "padding:15px;">
            <div class = "container">
                <div class = "row">
<!--                     <div class = "logo"> -->
                    <span class = "logo" onclick="location.href='home.html';">iShift</span>
                    <!-- </div> -->
                </div>
            </div>
            <div class = "container">
                <div class = "row">
                    <div class="btn-group-vertical sidebar" role="group" aria-label="...">
                        <a class="btn btn-default sidebar-item" href= 'home.html'><b>Calendar View</b></a>
                        <a class="btn btn-default sidebar-item" href = "whosworking.html"><b>Who's Working</b></a>
                        <a class="btn btn-default sidebar-item active" href = "assignshifts.html"><b>Assign Shifts</b></a>
                        <a class="btn btn-default sidebar-item" href = "setstorehours.html"><b>Set Store Hours</b></a>
                        <a class="btn btn-default sidebar-item" href = "setshifttimes.html"><b>Set Shift Times</b></a>
                    </div>
                </div>
            </div>
        </div>
        <div class = "col-md-10">
            <div class = "container">
                <div class = "row">
                    <div class = "welcome pull-right">
                        <p>Welcome, Sam!</p>
                        <p class = "time">The current time is: 10:22 AM</p>
                    </div>
                </div>
            </div>
            <div class = "container">
                <div class = "row">
                    <!-- <button type="button" class="btn btn-default">
                        <span></span>
                    </button> -->
                    <div class = "row" style = "margin-left:0px; margin-top:20px; max-width:80%;">
                        <p class = "week">Week of March 27 - April 2</p>
                        <!-- <button type="button" class="btn btn-default">
                            <span></span>
                        </button> -->
                    </div>
                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        Sunday Shifts
                                        <div id = "suStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                                <div class="panel-body">
                                    <ul id = "suShifts" style="list-style-type:none;">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingTwo">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                        Monday Shifts
                                        <div id = "moStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>                                    
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                                <div class="panel-body">
                                    <ul id = "moShifts" style="list-style-type:none;">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingThree">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                        Tuesday Shifts
                                        <div id = "tuStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                                <div class="panel-body">
                                    <ul id = "tuShifts" style="list-style-type:none;">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingFour">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                        Wednesday Shifts
                                        <div id = "weStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseFour" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour">
                                <div class="panel-body">
                                    <ul id = "weShifts" style="list-style-type:none;">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingFive">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                                        Thursday Shifts
                                        <div id = "thStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseFive" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFive">
                                <div class="panel-body">
                                    <ul id = "thShifts" style="list-style-type:none;">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingSix">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                                        Friday Shifts
                                        <div id = "frStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseSix" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSix">
                                <div class="panel-body">
                                    <ul id = "frShifts" style="list-style-type:none;">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingSeven">
                                <h4 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                                        Saturday Shifts
                                        <div id = "saStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>                                    
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseSeven" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingSeven">
                                <div class="panel-body">
                                    <ul id = "saShifts" style="list-style-type:none;">
                                    </ul>                                
                                </div>
                            </div>
                        </div>
                    </div>
                    <p><b>Workers: </b></p>
                    <ul class = "list-inline" id = "workerlist">
                    </ul>
                    <a class="btn btn-primary reassign-button" style= "background-color:#CC0033 !important;" id="editworkers"><b>Edit Workers</b></a>
                </div>
                <div class="modal fade" tabindex="-1" role="dialog" id="myModal">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title">Edit Workers:</h4>
                            </div>
                            <div class="modal-body">
                                <ul id = "modalworkerlist" style="list-style-type:none;margin-bottom:20px;">
                                </ul>
                                <div class="form-group">
                                    <label for="newworker">Add Worker:</label>
                                    <input type="text" class="form-control" id="newworker" placeholder="Worker Name">
                                    <button type="button" style="margin-top:10px;" class="btn btn-default" id="addworker">Add Worker</button>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal" style="background-color:#CC0033;color:#fff">Done</button>
                            </div>
                        </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div><!-- /.modal -->
                <div class="modal fade" tabindex="-1" role="dialog" id="myModal2">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title">Assign Shift:</h4>
                            </div>
                            <div class="modal-body">
                                <p id ="shifthours"></p>
                                <div class="form-group" id="shiftform">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" style="background-color:#CC0033;color:#fff" onclick="submitassignment()">Done</button>
                            </div>
                        </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div><!-- /.modal -->
            </div>
        </div>
    </body>
    <script>
        var myFirebaseRef = new Firebase("https://amber-inferno-6999.firebaseio.com/");
        var curshift=''
        var curday=''
        var curindex=-1
        function deleteworker(worker){
            console.log(worker)
            myFirebaseRef.on("value", function(snapshot) {
                workers = snapshot.val().workers;
                shifttimes = snapshot.val().workers;
                for(i=0;i<shifttimes.length;i++){
                    if(typeof(shifttimes[i]) == undefined){
                        for(j=0;j<shifttimes[i].length;j++){
                            if((typeof(shifttimes[i][j].assignedworkers) == undefined) || (shifttimes[i][j].assignedworkers != '')){
                                idx = shifttimes[i][j].assignedworkers.indexOf(worker);
                                if(idx>-1){
                                    shifttimes[i][j].assignedworkers.splice(idx,1);
                                }
                                shifttimes[i][j].assigned = shifttimes[i][j].assigned - 1
                                shifttimes[i][j].unassigned = shifttimes[i][j].unassigned + 1
                            }
                        }                        
                    }
                }
            });
            console.log(workers);
            idx = workers.indexOf(worker);
            console.log(idx);
            if(idx>-1){
                workers.splice(idx,1);
            }
            myFirebaseRef.child('workers').set(workers);
        }
        function editworkers(){
            $('#myModal').modal('show');
            myFirebaseRef.on("value", function(snapshot) {
                workers = snapshot.val().workers;
                $('#modalworkerlist').empty();
                if(typeof(workers) != 'undefined'){
                    for(i=0;i<workers.length;i++){
                        var worker = workers[i]
                        $('#modalworkerlist').append('<li style="margin-bottom:5px;">'+worker+'<button type="button" class="close" onclick="deleteworker(\''+worker+'\')" aria-label="Close"><span aria-hidden="true">&times;</span></button></li>');
                    }
                }
            });
        }
        function addworker(){
            name = $('#newworker').val();
            if(name != ""){
                myFirebaseRef.on("value", function(snapshot) {
                    workers = snapshot.val().workers;
                });
                if(typeof(workers) != 'undefined'){
                    workers.push(name);
                }
                else{
                    workers = [name]
                }
                myFirebaseRef.child('workers').set(workers);  
            }
        }
        function assignshift(event){
            shift = event.data.shift
            day = event.data.day
            index = event.data.index
            curshift = shift
            curday = day
            curindex = index
            hours = shift.hours
            clean_hours = []
            for(i=0;i<hours.length;i++){
                if(hours[i]< 12){
                    clean_hours.push(' ' + hours[i]+' AM');
                }
                else{
                    j = hours[i]-12
                    if(j==0){
                        j=12
                    }
                    clean_hours.push(' ' + j+' PM');
                }
            }
            myFirebaseRef.on("value", function(snapshot) {
                workers = snapshot.val().workers;
            });
            $('#shifthours').html(clean_hours);
            $('#shiftform').empty()
            console.log(shift.unassigned);
            for(a=0;a<Number(shift.unassigned);a++){
                n = a + 1
                $('#shiftform').append('<h5 style=margin-bottom:5px;>Worker ' + n + ':</h5>')
                $('#shiftform').append('<select class="form-control" style="margin-bottom:10px;" id="workerselect'+a+'">')
                for(b=0;b<workers.length;b++){
                    $('#workerselect'+a).append('<option>' +workers[b]+ '</option>');
                }
                $('#shiftform').append('</select>')
            }         
            $('#myModal2').modal('show')
        }
        function refreshlist(){
            myFirebaseRef.on("value", function(snapshot) {
                shifttimes = snapshot.val().shifttimes;
                sundayshifts = shifttimes.Sunday;
                mondayshifts = shifttimes.Monday;
                tuesdayshifts = shifttimes.Tuesday;
                wednesdayshifts = shifttimes.Wednesday;
                thursdayshifts = shifttimes.Thursday;
                fridayshifts = shifttimes.Friday;
                saturdayshifts = shifttimes.Saturday;
                workers = snapshot.val().workers;
                $('#suShifts').empty();
                $('#moShifts').empty();
                $('#tuShifts').empty();
                $('#weShifts').empty();
                $('#thShifts').empty();
                $('#frShifts').empty();
                $('#saShifts').empty();
                numassigned = 0
                numunassigned = 0
                if((typeof(sundayshifts) != 'undefined') && (sundayshifts != "")){
                    for(i=0;i<sundayshifts.length;i++){
                        shift = sundayshifts[i]
                        hours = shift.hours;
                        index = i
                        clean_hours = []
                        for(k=0;k<hours.length;k++){
                            if(hours[k]< 12){
                                clean_hours.push(' ' + hours[k]+' AM');
                            }
                            else{
                                j = hours[k]-12
                                if(j==0){
                                    j=12
                                }
                                clean_hours.push(' ' + j+' PM');
                            }
                        }
                        numassigned += Number(shift.assigned);
                        numunassigned += Number(shift.unassigned);
                        day = 'Sunday'
                        $('#suShifts').append('<li style="white-space:pre;margin-bottom:5px;"><b>Hours: </b>' + clean_hours + '   <b>Workers Assigned: </b>' + shift.assignedworkers + '   <b>Number Unassigned: <b>'+shift.unassigned+'<button type="button" class="btn btn-primary btn-xs pull-right" id = "suBtn" style="background-color:#CC0033;"">Assign Shift</button></li>');
                        $("#suBtn").click({shift: shift, day: day, index: index}, assignshift);
                    }
                }
                $('#suStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                numassigned = 0
                numunassigned = 0   
                if((typeof(mondayshifts) != 'undefined') && (mondayshifts != "")){
                    for(i=0;i<mondayshifts.length;i++){
                        shift = mondayshifts[i]
                        hours = shift.hours;
                        index = i
                        clean_hours = []
                        for(k=0;k<hours.length;k++){
                            if(hours[k]< 12){
                                clean_hours.push(' ' + hours[k]+' AM');
                            }
                            else{
                                j = hours[k]-12
                                if(j==0){
                                    j=12
                                }
                                clean_hours.push(' ' + j+' PM');
                            }
                        }
                        numassigned += Number(shift.assigned);
                        numunassigned += Number(shift.unassigned);
                        day = 'Monday'
                        $('#moShifts').append('<li style="white-space:pre;margin-bottom:5px;"><b>Hours: </b>' + clean_hours + '   <b>Workers Assigned: </b>' + shift.assignedworkers + '   <b>Number Unassigned: <b>'+shift.unassigned+'<button type="button" class="btn btn-primary btn-xs pull-right" id = "moBtn" style="background-color:#CC0033;"">Assign Shift</button></li>');
                        $("#moBtn").click({shift: shift, day: day, index: index}, assignshift);
                    }
                }
                $('#moStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                numassigned = 0
                numunassigned = 0
                if((typeof(tuesdayshifts) != 'undefined') && (tuesdayshifts != "")){
                    for(i=0;i<tuesdayshifts.length;i++){
                        shift = tuesdayshifts[i]
                        hours = shift.hours;
                        index = i
                        clean_hours = []
                        for(k=0;k<hours.length;k++){
                            if(hours[k]< 12){
                                clean_hours.push(' ' + hours[k]+' AM');
                            }
                            else{
                                j = hours[k]-12
                                if(j==0){
                                    j=12
                                }
                                clean_hours.push(' ' + j+' PM');
                            }
                        }
                        numassigned += Number(shift.assigned);
                        numunassigned += Number(shift.unassigned);
                        day = 'Tuesday'
                        $('#tuStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                        $('#tuShifts').append('<li style="white-space:pre;margin-bottom:5px;"><b>Hours: </b>' + clean_hours + '   <b>Workers Assigned: </b>' + shift.assignedworkers + '   <b>Number Unassigned: <b>'+shift.unassigned+'<button type="button" class="btn btn-primary btn-xs pull-right" id = "tuBtn" style="background-color:#CC0033;"">Assign Shift</button></li>');
                        $("#tuBtn").click({shift: shift, day: day, index: index}, assignshift);
                    }
                }
                $('#tuStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                numassigned = 0
                numunassigned = 0
                if((typeof(wednesdayshifts) != 'undefined') && (wednesdayshifts != "")){
                    for(i=0;i<wednesdayshifts.length;i++){
                        shift = wednesdayshifts[i]
                        hours = shift.hours;
                        index = i
                        clean_hours = []
                        for(k=0;k<hours.length;k++){
                            if(hours[k]< 12){
                                clean_hours.push(' ' + hours[k]+' AM');
                            }
                            else{
                                j = hours[k]-12
                                if(j==0){
                                    j=12
                                }
                                clean_hours.push(' ' + j+' PM');
                            }
                        }
                        numassigned += Number(shift.assigned);
                        numunassigned += Number(shift.unassigned);
                        day = 'Wednesday'
                        $('#weStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                        $('#weShifts').append('<li style="white-space:pre;margin-bottom:5px;"><b>Hours: </b>' + clean_hours + '   <b>Workers Assigned: </b>' + shift.assignedworkers + '   <b>Number Unassigned: <b>'+shift.unassigned+'<button type="button" class="btn btn-primary btn-xs pull-right" id = "weBtn" style="background-color:#CC0033;"">Assign Shift</button></li>');
                        $("#weBtn").click({shift: shift, day: day, index: index}, assignshift);
                    }
                }
                $('#weStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                numassigned = 0
                numunassigned = 0
                if((typeof(thursdayshifts) != 'undefined') && (thursdayshifts != "")){
                    for(i=0;i<thursdayshifts.length;i++){
                        shift = thursdayshifts[i]
                        hours = shift.hours;
                        index = i
                        clean_hours = []
                        for(k=0;k<hours.length;k++){
                            if(hours[k]< 12){
                                clean_hours.push(' ' + hours[k]+' AM');
                            }
                            else{
                                j = hours[k]-12
                                if(j==0){
                                    j=12
                                }
                                clean_hours.push(' ' + j+' PM');
                            }
                        }
                        numassigned += Number(shift.assigned);
                        numunassigned += Number(shift.unassigned);
                        day = 'Thursday'
                        $('#thStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                        $('#thShifts').append('<li style="white-space:pre;margin-bottom:5px;"><b>Hours: </b>' + clean_hours + '   <b>Workers Assigned: </b>' + shift.assignedworkers + '   <b>Number Unassigned: <b>'+shift.unassigned+'<button type="button" class="btn btn-primary btn-xs pull-right" id = "thBtn" style="background-color:#CC0033;"">Assign Shift</button></li>');
                        $("#thBtn").click({shift: shift, day: day, index: index}, assignshift);
                    }
                }
                $('#thStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                numassigned = 0
                numunassigned = 0
                if((typeof(fridayshifts) != 'undefined') && (fridayshifts != "")){
                    for(i=0;i<fridayshifts.length;i++){
                        shift = fridayshifts[i]
                        hours = shift.hours;
                        index = i
                        clean_hours = []
                        for(k=0;k<hours.length;k++){
                            if(hours[k]< 12){
                                clean_hours.push(' ' + hours[k]+' AM');
                            }
                            else{
                                j = hours[k]-12
                                if(j==0){
                                    j=12
                                }
                                clean_hours.push(' ' + j+' PM');
                            }
                        }
                        numassigned += Number(shift.assigned);
                        numunassigned += Number(shift.unassigned);
                        day = 'Friday'
                        $('#frStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                        $('#frShifts').append('<li style="white-space:pre;margin-bottom:5px;"><b>Hours: </b>' + clean_hours + '   <b>Workers Assigned: </b>' + shift.assignedworkers + '   <b>Number Unassigned: <b>'+shift.unassigned+'<button type="button" class="btn btn-primary btn-xs pull-right" id = "frBtn" style="background-color:#CC0033;"">Assign Shift</button></li>');
                        $("#frBtn").click({shift: shift, day: day, index: index}, assignshift);
                    }
                }
                $('#frStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                numassigned = 0
                numunassigned = 0
                if((typeof(saturdayshifts) != 'undefined') && (saturdayshifts != "")){
                    for(i=0;i<saturdayshifts.length;i++){
                        shift = saturdayshifts[i]
                        hours = shift.hours;
                        index = i
                        clean_hours = []
                        for(k=0;k<hours.length;k++){
                            if(hours[k]< 12){
                                clean_hours.push(' ' + hours[k]+' AM');
                            }
                            else{
                                j = hours[k]-12
                                if(j==0){
                                    j=12
                                }
                                clean_hours.push(' ' + j+' PM');
                            }
                        }
                        numassigned += Number(shift.assigned);
                        numunassigned += Number(shift.unassigned);
                        day = 'Saturday'
                        $('#saStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                        $('#saShifts').append('<li style="white-space:pre;margin-bottom:5px;"><b>Hours: </b>' + clean_hours + '   <b>Workers Assigned: </b>' + shift.assignedworkers + '   <b>Number Unassigned: <b>'+shift.unassigned+'<button type="button" class="btn btn-primary btn-xs pull-right"  id = "saBtn" style="background-color:#CC0033;"">Assign Shift</button></li>');
                        $("#saBtn").click({shift: shift, day: day, index: index}, assignshift);
                    }
                }
                $('#saStats').html('<p><b>Assigned</b>: ' + numassigned + '   <b>Unassigned</b>: ' + numunassigned + '</p>');
                numassigned = 0
                numunassigned = 0
                $('#workerlist').empty();
                if(typeof(workers) != 'undefined'){
                    for(i=0;i<workers.length;i++){
                        $('#workerlist').append('<li>'+workers[i]+'</li>');
                    }
                }
            });
        }
        function submitassignment(){
            shift = curshift;
            day = curday;
            index = curindex
            workersselected = [];
            duplicate = false;
            for(i=0;i<$('select').length;i++){
                name = $($('select')[i]).find(":selected").text()
                if(workersselected.indexOf(name)>-1){
                    duplicate = true;
                }
                workersselected.push(name)
            }
            if(duplicate){
                alert('Please select unique workers');
            }
            else{
                if(shift.assignedworkers != ''){
                    assigned_workers = []
                    for(i=0;i<shift.assignedworkers.length;i++){
                        assigned_workers.push(shift.assignedworkers[i]);
                    }
                    for(i=0;i<workersselected.length;i++){
                        assigned_workers.push(workersselected[i]);
                    }
                }
                else{
                    assigned_workers = workersselected
                }
                newFirebaseRef = new Firebase("https://amber-inferno-6999.firebaseio.com/shifttimes/"+day+"/"+index);
                newFirebaseRef.child('assignedworkers').set(assigned_workers)
                newFirebaseRef.child('assigned').set(assigned_workers.length)
                newFirebaseRef.child('unassigned').set(0)
                $('#myModal2').modal('hide');
                refreshlist();
            }
            location.reload();
        }
        $(document).ready(function(){
            $('#logo').click(function() {

            });
            refreshlist();
            document.getElementById("editworkers").addEventListener ("click", editworkers, false);
            document.getElementById("addworker").addEventListener ("click", addworker, false);
            function getMaxOfArray(numArray) {
              return Math.max.apply(null, numArray);
            }
            function getMinOfArray(numArray) {
              return Math.min.apply(null, numArray);
            }
            
        });
    </script>
</html>