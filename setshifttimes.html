<!DOCTYPE html>
<html>
    <head>
        <title>iShift</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <link href="css/bootstrap.css" type="text/css" rel="stylesheet"/>
        <link href="css/jquery-ui.css" type="text/css" rel="stylesheet"/>
        <link href="css/styles.css" type="text/css" rel="stylesheet"/>
        <script src="js/jquery-1.12.3.js"></script>
        <script src="js/jquery-ui.js"></script>
        <script src="js/bootstrap.js"></script>
        <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    </head>
    <body>
        <div class = "col-md-2" style = "padding:15px;">
            <div class = "container">
                <div class = "row">
                    <!-- <div class = "logo"> -->
                    <span class = "logo" onclick="location.href='home.html';">iShift</span>
                    <!-- </div> -->
                </div>
            </div>
            <div class = "container">
                <div class = "row">
                    <div class="btn-group-vertical sidebar" role="group" aria-label="...">
                        <a class="btn btn-default sidebar-item" href = "home.html"><b>Calendar View</b></a>
                        <a class="btn btn-default sidebar-item" href = "whosworking.html"><b>Who's Working</b></a>
                        <a class="btn btn-default sidebar-item" href = "assignshifts.html"><b>Assign Shifts</b></a>
                        <a class="btn btn-default sidebar-item" href = "setstorehours.html"><b>Set Store Hours</b></a>
                        <a class="btn btn-default sidebar-item active" href = "setshifttimes.html"><b>Set Shift Times</b></a>
                    </div>
                </div>
            </div>
        </div>
        <div class = "col-md-10">
            <div class = "container">
                <div class = "row">
                    <div class = "welcome pull-right">
                        <p>Welcome, Sam!</p>
                        <p class = "time">The current time is: 10:22 AM</p>
                    </div>
                </div>
            </div>
            <div class = "container cal-container" style="display:none;">
                <div class = "row" style = "margin-top:15px">
                    <div class = "color-keys pull-right">
                            <div class = "key selected"></div> <p style = "display:inline-block;"> = Open</p>
                            <div class = "key unselected"></div> <p style = "display:inline-block;"> = Unassigned</p>
                            <div class = "key closed"></div> <p style = "display:inline-block;"> = Closed</p>
                        </div>
                    <table class="table table-bordered calendar"  cellpadding="0"  cellspacing="0" id="calendar">
                        <tbody class = "calendartable">
                            <tr>
                                <td class = "cal-item-white tlabel"></td>
                                <td class = "cal-item-white tlabel">SUNDAY</td>
                                <td class = "cal-item-white tlabel">MONDAY</td>
                                <td class = "cal-item-white tlabel">TUESDAY</td>
                                <td class = "cal-item-white tlabel">WEDNESDAY</td>                                
                                <td class = "cal-item-white tlabel">THURSDAY</td>
                                <td class = "cal-item-white tlabel">FRIDAY</td>
                                <td class = "cal-item-white tlabel">SATURDAY</td>
                            </tr>
                            <tr id = "0">
                                <td class = "cal-item-white tlabel">12 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su0"></td>
                                <td class = "cal-item-clickable disabled" id = "mo0"></td>
                                <td class = "cal-item-clickable disabled" id = "tu0"></td>
                                <td class = "cal-item-clickable disabled" id = "we0"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th0"></td>
                                <td class = "cal-item-clickable disabled" id = "fr0"></td>
                                <td class = "cal-item-clickable disabled" id = "sa0"></td>
                            </tr>
                            <tr id = "1">
                                <td class = "cal-item-white tlabel">1 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su1"></td>
                                <td class = "cal-item-clickable disabled" id = "mo1"></td>
                                <td class = "cal-item-clickable disabled" id = "tu1"></td>
                                <td class = "cal-item-clickable disabled" id = "we1"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th1"></td>
                                <td class = "cal-item-clickable disabled" id = "fr1"></td>
                                <td class = "cal-item-clickable disabled" id = "sa1"></td>
                            </tr>
                            <tr id = "2">
                                <td class = "cal-item-white tlabel">2 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su2"></td>
                                <td class = "cal-item-clickable disabled" id = "mo2"></td>
                                <td class = "cal-item-clickable disabled" id = "tu2"></td>
                                <td class = "cal-item-clickable disabled" id = "we2"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th2"></td>
                                <td class = "cal-item-clickable disabled" id = "fr2"></td>
                                <td class = "cal-item-clickable disabled" id = "sa2"></td>
                            </tr>
                            <tr id = "3">
                                <td class = "cal-item-white tlabel">3 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su3"></td>
                                <td class = "cal-item-clickable disabled" id = "mo3"></td>
                                <td class = "cal-item-clickable disabled" id = "tu3"></td>
                                <td class = "cal-item-clickable disabled" id = "we3"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th3"></td>
                                <td class = "cal-item-clickable disabled" id = "fr3"></td>
                                <td class = "cal-item-clickable disabled" id = "sa3"></td>
                            </tr>
                            <tr id = "4">
                                <td class = "cal-item-white tlabel">4 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su4"></td>
                                <td class = "cal-item-clickable disabled" id = "mo4"></td>
                                <td class = "cal-item-clickable disabled" id = "tu4"></td>
                                <td class = "cal-item-clickable disabled" id = "we4"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th4"></td>
                                <td class = "cal-item-clickable disabled" id = "fr4"></td>
                                <td class = "cal-item-clickable disabled" id = "sa4"></td>
                            </tr>  
                            <tr id = "5">
                                <td class = "cal-item-white tlabel">5 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su5"></td>
                                <td class = "cal-item-clickable disabled" id = "mo5"></td>
                                <td class = "cal-item-clickable disabled" id = "tu5"></td>
                                <td class = "cal-item-clickable disabled" id = "we5"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th5"></td>
                                <td class = "cal-item-clickable disabled" id = "fr5"></td>
                                <td class = "cal-item-clickable disabled" id = "sa5"></td>
                            </tr>
                            <tr id = "6">
                                <td class = "cal-item-white tlabel">6 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su6"></td>
                                <td class = "cal-item-clickable disabled" id = "mo6"></td>
                                <td class = "cal-item-clickable disabled" id = "tu6"></td>
                                <td class = "cal-item-clickable disabled" id = "we6"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th6"></td>
                                <td class = "cal-item-clickable disabled" id = "fr6"></td>
                                <td class = "cal-item-clickable disabled" id = "sa6"></td>
                            </tr>
                            <tr id = "7">
                                <td class = "cal-item-white tlabel">7 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su7"></td>
                                <td class = "cal-item-clickable disabled" id = "mo7"></td>
                                <td class = "cal-item-clickable disabled" id = "tu7"></td>
                                <td class = "cal-item-clickable disabled" id = "we7"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th7"></td>
                                <td class = "cal-item-clickable disabled" id = "fr7"></td>
                                <td class = "cal-item-clickable disabled" id = "sa7"></td>
                            </tr>
                            <tr id = "8">
                                <td class = "cal-item-white tlabel">8 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su8"></td>
                                <td class = "cal-item-clickable disabled" id = "mo8"></td>
                                <td class = "cal-item-clickable disabled" id = "tu8"></td>
                                <td class = "cal-item-clickable disabled" id = "we8"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th8"></td>
                                <td class = "cal-item-clickable disabled" id = "fr8"></td>
                                <td class = "cal-item-clickable disabled" id = "sa8"></td>
                            </tr>
                            <tr id = "9">
                                <td class = "cal-item-white tlabel">9 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su9"></td>
                                <td class = "cal-item-clickable disabled" id = "mo9"></td>
                                <td class = "cal-item-clickable disabled" id = "tu9"></td>
                                <td class = "cal-item-clickable disabled" id = "we9"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th9"></td>
                                <td class = "cal-item-clickable disabled" id = "fr9"></td>
                                <td class = "cal-item-clickable disabled" id = "sa9"></td>
                            </tr>
                            <tr id = "10">
                                <td class = "cal-item-white tlabel">10 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su10"></td>
                                <td class = "cal-item-clickable disabled" id = "mo10"></td>
                                <td class = "cal-item-clickable disabled" id = "tu10"></td>
                                <td class = "cal-item-clickable disabled" id = "we10"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th10"></td>
                                <td class = "cal-item-clickable disabled" id = "fr10"></td>
                                <td class = "cal-item-clickable disabled" id = "sa10"></td>
                            </tr>
                            <tr id = "11">
                                <td class = "cal-item-white tlabel">11 AM</td>
                                <td class = "cal-item-clickable disabled" id = "su11"></td>
                                <td class = "cal-item-clickable disabled" id = "mo11"></td>
                                <td class = "cal-item-clickable disabled" id = "tu11"></td>
                                <td class = "cal-item-clickable disabled" id = "we11"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th11"></td>
                                <td class = "cal-item-clickable disabled" id = "fr11"></td>
                                <td class = "cal-item-clickable disabled" id = "sa11"></td>
                            </tr>
                            <tr id = "12">
                                <td class = "cal-item-white tlabel">12 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su12"></td>
                                <td class = "cal-item-clickable disabled" id = "mo12"></td>
                                <td class = "cal-item-clickable disabled" id = "tu12"></td>
                                <td class = "cal-item-clickable disabled" id = "we12"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th12"></td>
                                <td class = "cal-item-clickable disabled" id = "fr12"></td>
                                <td class = "cal-item-clickable disabled" id = "sa12"></td>
                            </tr>
                            <tr id = "13">
                                <td class = "cal-item-white tlabel">1 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su13"></td>
                                <td class = "cal-item-clickable disabled" id = "mo13"></td>
                                <td class = "cal-item-clickable disabled" id = "tu13"></td>
                                <td class = "cal-item-clickable disabled" id = "we13"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th13"></td>
                                <td class = "cal-item-clickable disabled" id = "fr13"></td>
                                <td class = "cal-item-clickable disabled" id = "sa13"></td>
                            </tr>
                            <tr id = "14">
                                <td class = "cal-item-white tlabel">2 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su14"></td>
                                <td class = "cal-item-clickable disabled" id = "mo14"></td>
                                <td class = "cal-item-clickable disabled" id = "tu14"></td>
                                <td class = "cal-item-clickable disabled" id = "we14"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th14"></td>
                                <td class = "cal-item-clickable disabled" id = "fr14"></td>
                                <td class = "cal-item-clickable disabled" id = "sa14"></td>
                            </tr>
                            <tr id = "15">
                                <td class = "cal-item-white tlabel">3 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su15"></td>
                                <td class = "cal-item-clickable disabled" id = "mo15"></td>
                                <td class = "cal-item-clickable disabled" id = "tu15"></td>
                                <td class = "cal-item-clickable disabled" id = "we15"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th15"></td>
                                <td class = "cal-item-clickable disabled" id = "fr15"></td>
                                <td class = "cal-item-clickable disabled" id = "sa15"></td>
                            </tr>
                            <tr id = "16">
                                <td class = "cal-item-white tlabel">4 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su16"></td>
                                <td class = "cal-item-clickable disabled" id = "mo16"></td>
                                <td class = "cal-item-clickable disabled" id = "tu16"></td>
                                <td class = "cal-item-clickable disabled" id = "we16"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th16"></td>
                                <td class = "cal-item-clickable disabled" id = "fr16"></td>
                                <td class = "cal-item-clickable disabled" id = "sa16"></td>
                            </tr>
                            <tr id = "17">
                                <td class = "cal-item-white tlabel">5 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su17"></td>
                                <td class = "cal-item-clickable disabled" id = "mo17"></td>
                                <td class = "cal-item-clickable disabled" id = "tu17"></td>
                                <td class = "cal-item-clickable disabled" id = "we17"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th17"></td>
                                <td class = "cal-item-clickable disabled" id = "fr17"></td>
                                <td class = "cal-item-clickable disabled" id = "sa17"></td>
                            </tr>
                            <tr id = "18">
                                <td class = "cal-item-white tlabel">6 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su18"></td>
                                <td class = "cal-item-clickable disabled" id = "mo18"></td>
                                <td class = "cal-item-clickable disabled" id = "tu18"></td>
                                <td class = "cal-item-clickable disabled" id = "we18"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th18"></td>
                                <td class = "cal-item-clickable disabled" id = "fr18"></td>
                                <td class = "cal-item-clickable disabled" id = "sa18"></td>
                            </tr>
                            <tr id = "19">
                                <td class = "cal-item-white tlabel">7 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su19"></td>
                                <td class = "cal-item-clickable disabled" id = "mo19"></td>
                                <td class = "cal-item-clickable disabled" id = "tu19"></td>
                                <td class = "cal-item-clickable disabled" id = "we19"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th19"></td>
                                <td class = "cal-item-clickable disabled" id = "fr19"></td>
                                <td class = "cal-item-clickable disabled" id = "sa19"></td>
                            </tr>
                            <tr id = "20">
                                <td class = "cal-item-white tlabel">8 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su20"></td>
                                <td class = "cal-item-clickable disabled" id = "mo20"></td>
                                <td class = "cal-item-clickable disabled" id = "tu20"></td>
                                <td class = "cal-item-clickable disabled" id = "we20"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th20"></td>
                                <td class = "cal-item-clickable disabled" id = "fr20"></td>
                                <td class = "cal-item-clickable disabled" id = "sa20"></td>
                            </tr>
                            <tr id = "21">
                                <td class = "cal-item-white tlabel">9 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su21"></td>
                                <td class = "cal-item-clickable disabled" id = "mo21"></td>
                                <td class = "cal-item-clickable disabled" id = "tu21"></td>
                                <td class = "cal-item-clickable disabled" id = "we21"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th21"></td>
                                <td class = "cal-item-clickable disabled" id = "fr21"></td>
                                <td class = "cal-item-clickable disabled" id = "sa21"></td>
                            </tr>
                            <tr id = "22">
                                <td class = "cal-item-white tlabel">10 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su22"></td>
                                <td class = "cal-item-clickable disabled" id = "mo22"></td>
                                <td class = "cal-item-clickable disabled" id = "tu22"></td>
                                <td class = "cal-item-clickable disabled" id = "we22"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th22"></td>
                                <td class = "cal-item-clickable disabled" id = "fr22"></td>
                                <td class = "cal-item-clickable disabled" id = "sa22"></td>
                            </tr>
                            <tr id = "23">
                                <td class = "cal-item-white tlabel">11 PM</td>
                                <td class = "cal-item-clickable disabled" id = "su23"></td>
                                <td class = "cal-item-clickable disabled" id = "mo23"></td>
                                <td class = "cal-item-clickable disabled" id = "tu23"></td>
                                <td class = "cal-item-clickable disabled" id = "we23"></td>                                
                                <td class = "cal-item-clickable disabled" id = "th23"></td>
                                <td class = "cal-item-clickable disabled" id = "fr23"></td>
                                <td class = "cal-item-clickable disabled" id = "sa23"></td>
                            </tr>
                        </tbody>                   
                    </table>
                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                        Current Shifts
                                        <span class="small">Click here to view/edit current shifts</span>
                                        <span class ="pull-right" id ="numshifts"></span>
                                        <div id = "suStats" style="white-space:pre;display:inline-block" class="pull-right">
                                        </div>
                                    </a>
                                </h4>
                            </div>
                            <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                                <div class="panel-body">
                                    <ul id = "shiftlist" style="list-style-type:none;">
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p>Use your mouse to drag over the hours you would like to set as a default shift. Please do so one shift at a time.</p>
                    <div class = "pull-right">
                        <button type="button" class="btn btn-default btn-lg" style="background-color:#CC0033;color:#fff" id="submithours">Submit Shift</button>
                    </div>
                    <div class="modal fade" tabindex="-1" role="dialog" id="myModal">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                    <h4 class="modal-title">Create Shift:</h4>
                                </div>
                                <div class="modal-body">
                                    <ul id = "hourslist" style="list-style-type:none">
                                    </ul>
                                    <div id = 'repeatboxes'>
                                        <h5>Repeat on the following days:</h5>
                                    </div>
                                      <div class="form-group">
                                        <label for="numemployees">Input the number of employees required for this shift (required):</label>
                                        <input type="text" class="form-control" id="numemployees" placeholder="Number of Employees">
                                      </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Edit Shift</button>
                                    <button type="button" class="btn btn-default" style="background-color:#CC0033;color:#fff" id="savehours">Save Shift</button>
                                </div>
                            </div><!-- /.modal-content -->
                        </div><!-- /.modal-dialog -->
                    </div><!-- /.modal -->
                </div>
            </div>
        </div>
    </body>
    <script>
        sundayh = []
        mondayh = []
        tuesdayh = []
        wednesdayh = []
        thursdayh = []
        fridayh = []
        saturdayh = []
        var myFirebaseRef = new Firebase("https://amber-inferno-6999.firebaseio.com/");
        function getMaxOfArray(numArray) {
          return Math.max.apply(null, numArray);
        }
        function getMinOfArray(numArray) {
          return Math.min.apply(null, numArray);
        }
        function submitHours(){
            tds = $(".cal-item-clickable");
            elems = []
            for(i=0; i< tds.length; i++){
                if(!($(tds[i]).attr('class').indexOf('tlabel') >= 0) && !($(tds[i]).attr('class').indexOf('disabled') >= 0)){
                    elems.push(tds[i]);
                }
            }
            sunday = []
            monday = []
            tuesday = []
            wednesday = []
            thursday = []
            friday = []
            saturday = []
            sundayh = []
            mondayh = []
            tuesdayh = []
            wednesdayh = []
            thursdayh = []
            fridayh = []
            saturdayh = []
            for(i=0; i<elems.length;i++){
                if($(elems[i]).attr('id').substring(0,2) == "su"){
                    if($(elems[i]).attr('id').substring(2,4) < 12){
                        if($(elems[i]).attr('id').substring(2,4) == 0){
                            hours = "12 AM"
                        }
                        else{
                            hours = $(elems[i]).attr('id').substring(2,4) + " AM"
                        }
                    }
                    else{
                        if($(elems[i]).attr('id').substring(2,4) == 12){
                            hours = "12 PM"
                        }
                        else{
                            hour = $(elems[i]).attr('id').substring(2,4) - 12 
                            hours =  hour + " PM"
                        }
                    }
                    sundayh.push($(elems[i]).attr('id').substring(2,4))
                    sunday.push(" " + hours);
                }
                if($(elems[i]).attr('id').substring(0,2) == "mo"){
                    if($(elems[i]).attr('id').substring(2,4) < 12){
                        if($(elems[i]).attr('id').substring(2,4) == 0){
                            hours = "12 AM"
                        }
                        else{
                            hours = $(elems[i]).attr('id').substring(2,4) + " AM"
                        }
                    }
                    else{
                        if($(elems[i]).attr('id').substring(2,4) == 12){
                            hours = "12 PM"
                        }
                        else{
                            hour = $(elems[i]).attr('id').substring(2,4) - 12 
                            hours =  hour + " PM"
                        }
                    }
                    mondayh.push($(elems[i]).attr('id').substring(2,4))
                    monday.push(" " + hours);                
                }
                if($(elems[i]).attr('id').substring(0,2) == "tu"){
                    if($(elems[i]).attr('id').substring(2,4) < 12){
                        if($(elems[i]).attr('id').substring(2,4) == 0){
                            hours = "12 AM"
                        }
                        else{
                            hours = $(elems[i]).attr('id').substring(2,4) + " AM"
                        }
                    }
                    else{
                        if($(elems[i]).attr('id').substring(2,4) == 12){
                            hours = "12 PM"
                        }
                        else{
                            hour = $(elems[i]).attr('id').substring(2,4) - 12 
                            hours =  hour + " PM"
                        }
                    }
                    tuesdayh.push($(elems[i]).attr('id').substring(2,4))
                    tuesday.push(" " + hours);                
                }
                if($(elems[i]).attr('id').substring(0,2) == "we"){
                    if($(elems[i]).attr('id').substring(2,4) < 12){
                        if($(elems[i]).attr('id').substring(2,4) == 0){
                            hours = "12 AM"
                        }
                        else{
                            hours = $(elems[i]).attr('id').substring(2,4) + " AM"
                        }
                    }
                    else{
                        if($(elems[i]).attr('id').substring(2,4) == 12){
                            hours = "12 PM"
                        }
                        else{
                            hour = $(elems[i]).attr('id').substring(2,4) - 12 
                            hours =  hour + " PM"
                        }
                    }
                    wednesdayh.push($(elems[i]).attr('id').substring(2,4))
                    wednesday.push(" " + hours);                
                }
                if($(elems[i]).attr('id').substring(0,2) == "th"){
                    if($(elems[i]).attr('id').substring(2,4) < 12){
                        if($(elems[i]).attr('id').substring(2,4) == 0){
                            hours = "12 AM"
                        }
                        else{
                            hours = $(elems[i]).attr('id').substring(2,4) + " AM"
                        }
                    }
                    else{
                        if($(elems[i]).attr('id').substring(2,4) == 12){
                            hours = "12 PM"
                        }
                        else{
                            hour = $(elems[i]).attr('id').substring(2,4) - 12 
                            hours =  hour + " PM"
                        }
                    }
                    thursdayh.push($(elems[i]).attr('id').substring(2,4))
                    thursday.push(" " + hours);                
                }
                if($(elems[i]).attr('id').substring(0,2) == "fr"){
                    if($(elems[i]).attr('id').substring(2,4) < 12){
                        if($(elems[i]).attr('id').substring(2,4) == 0){
                            hours = "12 AM"
                        }
                        else{
                            hours = $(elems[i]).attr('id').substring(2,4) + " AM"
                        }
                    }
                    else{
                        if($(elems[i]).attr('id').substring(2,4) == 12){
                            hours = "12 PM"
                        }
                        else{
                            hour = $(elems[i]).attr('id').substring(2,4) - 12 
                            hours =  hour + " PM"
                        }
                    }
                    fridayh.push($(elems[i]).attr('id').substring(2,4))
                    friday.push(" " + hours);                
                }
                if($(elems[i]).attr('id').substring(0,2) == "sa"){
                    if($(elems[i]).attr('id').substring(2,4) < 12){
                        if($(elems[i]).attr('id').substring(2,4) == 0){
                            hours = "12 AM"
                        }
                        else{
                            hours = $(elems[i]).attr('id').substring(2,4) + " AM"
                        }
                    }
                    else{
                        if($(elems[i]).attr('id').substring(2,4) == 12){
                            hours = "12 PM"
                        }
                        else{
                            hour = $(elems[i]).attr('id').substring(2,4) - 12 
                            hours =  hour + " PM"
                        }
                    }
                    saturdayh.push($(elems[i]).attr('id').substring(2,4))
                    saturday.push(" " + hours);                
                }
            }
            $('#hourslist').empty();
            $('#repeatboxes').empty();
            count = 0
            day = ''
            days_of_the_week = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']
            if(sunday.length > 0){
                count += 1
                day = 'Sunday'
                $('#hourslist').append("<li style='text-align:center'><b>Sunday: </b>" + sunday + "</li><hr>");
            }
            if(monday.length > 0){
                count += 1
                day = 'Monday'
                $('#hourslist').append("<li style='text-align:center'><b>Monday: </b>" + monday + "</li><hr>");
            }
            if(tuesday.length > 0){
                count += 1
                day = 'Tuesday'
                $('#hourslist').append("<li style='text-align:center'><b>Tuesday: </b>" + tuesday + "</li><hr>");
            }
            if(wednesday.length > 0){
                count += 1
                day = 'Wednesday'
                $('#hourslist').append("<li style='text-align:center'><b>Wednesday: </b>" + wednesday + "</li><hr>");
            }
            if(thursday.length > 0){
                count += 1
                day = 'Thursday'
                $('#hourslist').append("<li style='text-align:center'><b>Thursday: </b>" + thursday + "</li><hr>");
            }
            if(friday.length > 0){
                count += 1
                day = 'Friday'
                $('#hourslist').append("<li style='text-align:center'><b>Friday: </b>" + friday + "</li><hr>");
            }
            if(saturday.length > 0){
                count += 1
                day = 'Saturday'
                $('#hourslist').append("<li style='text-align:center'><b>Saturday: </b>" + saturday + "</li><hr>");
            }
            for(i=0; i< days_of_the_week.length; i++){
                if(days_of_the_week[i] != day){
                  checkbox = '<div class="checkbox"><label><input type="checkbox" id = "' + days_of_the_week[i] + 'box" name = "' + days_of_the_week[i]  + '"" /> ' +days_of_the_week[i]+ '</label></div>'
                  $('#repeatboxes').append(checkbox);
                }
                else{
                    checkbox = '<div class="checkbox"><label id ="disabledbox"><input type="checkbox" disabled="disabled" checked="checked" name = "' + days_of_the_week[i]  + '" />' + days_of_the_week[i] +'</label></div>'
                    $('#repeatboxes').append(checkbox);
                }
            }
            if(count > 1){
                alert("Please create a default shift for one day at a time");
            }
            else if(count == 0){
                alert("Please create a default shift before submitting");
            }
            else{
                $('#myModal').modal('show');
            }
        }
        function setcal(){
            myFirebaseRef.on("value", function(snapshot) {
                storehours = snapshot.val().storehours;
                hours_list = []
                hours_list.push.apply(hours_list, storehours.sunday)
                hours_list.push.apply(hours_list, storehours.monday)
                hours_list.push.apply(hours_list, storehours.tuesday)
                hours_list.push.apply(hours_list, storehours.wednesday)
                hours_list.push.apply(hours_list, storehours.thursday)
                hours_list.push.apply(hours_list, storehours.friday)
                hours_list.push.apply(hours_list, storehours.saturday)
                minhour = getMinOfArray(hours_list);
                maxhour = getMaxOfArray(hours_list);
                hours_range = []
                for (i=0; i<24; i++){
                    if((i<minhour) || (i>maxhour)){
                        $('#'+i).remove();
                    }
                }
                for(i=minhour; i<maxhour+1; i++){
                    if(!(storehours.sunday.indexOf(i.toString()) >= 0)){
                        $('#su' + i).removeClass('disabled');
                        $('#su' + i).addClass('extra-disabled');
                    }
                    if(!(storehours.monday.indexOf(i.toString()) >= 0)){
                        $('#mo' + i).removeClass('disabled');
                        $('#mo' + i).addClass('extra-disabled');                    
                    }
                    if(!(storehours.tuesday.indexOf(i.toString()) >= 0)){
                        $('#tu' + i).removeClass('disabled');
                        $('#tu' + i).addClass('extra-disabled');
                    }
                    if(!(storehours.wednesday.indexOf(i.toString()) >= 0)){
                        $('#we' + i).removeClass('disabled');
                        $('#we' + i).addClass('extra-disabled');
                    }
                    if(!(storehours.thursday.indexOf(i.toString()) >= 0)){
                        $('#th' + i).removeClass('disabled');
                        $('#th' + i).addClass('extra-disabled');
                    }
                    if(!(storehours.friday.indexOf(i.toString()) >= 0)){
                        $('#fr' + i).removeClass('disabled');
                        $('#fr' + i).addClass('extra-disabled');
                    }
                    if(!(storehours.saturday.indexOf(i.toString()) >= 0)){
                        $('#sa' + i).removeClass('disabled');
                        $('#sa' + i).addClass('extra-disabled');
                    }
                }
                $('.cal-container').css('display', '');
                shifttimes = snapshot.val().shifttimes;
                $('#shiftlist').empty();
                numshifts = 0
                for(key in shifttimes){
                    if(shifttimes.hasOwnProperty(key)){
                        for(j=0;j<shifttimes[key].length;j++){
                            shift = shifttimes[key][j]
                            hours = shift.hours
                            clean_hours = []
                            index = j
                            for(k=0;k<hours.length;k++){
                                if(hours[k]< 12){
                                    if(hours[k] == 0){
                                        clean_hours.push(' 12 AM');
                                    }
                                    else{
                                        clean_hours.push(' ' + hours[k]+' AM');
                                    }
                                }
                                else{
                                    p = hours[k]-12
                                    if(p==0){
                                        p=12
                                    }
                                    clean_hours.push(' ' + p +' PM');
                                }
                            }
                            numshifts += 1
                            $('#shiftlist').append('<li style="margin-bottom:5px;white-space:pre;"><b>Day: </b>'+key+'  <b>Hours: </b>'+clean_hours+'  <b>Workers Assigned: </b>' + shift.assignedworkers+ ' <b>Unassigned: </b>' + shift.unassigned + '<button type="button" class="close" onclick="deleteshift(\''+key+","+index+'\')" aria-label="Close"><span aria-hidden="true">&times;</span></button></li>');
                        }
                    }
                }
                $('#numshifts').html("Number of Shifts: " + numshifts);
            });
        }
        function deleteshift(data){
            day = data.split(',')[0];
            index = data.split(',')[1];
            var shiftref = new Firebase("https://amber-inferno-6999.firebaseio.com/shifttimes/"+day+"/"+index);
            shiftref.once("value",function(snapshot){
                shift = snapshot.val();
            });
            if(confirm("Are you sure you want to delete this shift on " + day + "?")){
                var onComplete = function(error){
                    setcal();
                }
                shiftref.remove(onComplete);
            }
        }
        $(document).ready(function(){
            setcal();
            document.getElementById("submithours").addEventListener ("click", submitHours, false);
            document.getElementById("savehours").addEventListener ("click", saveHours, false);
            function getMaxOfArray(numArray) {
              return Math.max.apply(null, numArray);
            }
            function getMinOfArray(numArray) {
              return Math.min.apply(null, numArray);
            }
            function saveHours(){
                if((isNaN($('#numemployees').val())) || ($('#numemployees').val() == '')){
                    alert('Please input a number for the number of required employees')
                }
                else{
                    $('#myModal').modal('hide');
                    myFirebaseRef.on("value", function(snapshot) {
                        shifttimes = snapshot.val().shifttimes;
                        day = $('#disabledbox').text()
                        numemployees = $('#numemployees').val();
                        var selected = [];
                        $('#repeatboxes input:checked').each(function() {
                            selected.push($(this).attr('name'));
                        });
                        if(day == 'Sunday'){
                            shift_hours = sundayh
                        }
                        else if(day == 'Monday'){
                            shift_hours = mondayh
                        }
                        else if(day == 'Tuesday'){
                            shift_hours = tuesdayh
                        }
                        else if(day == 'Wednesday'){
                            shift_hours = wednesdayh
                        }
                        else if(day == 'Thursday'){
                            shift_hours = thursdayh
                        }
                        else if(day == 'Friday'){
                            shift_hours = fridayh
                        }
                        else if(day == 'Saturday'){
                            shift_hours = saturdayh
                        }
                        for(i=0; i<selected.length; i++){
                            if(selected[i] == 'Sunday'){
                                if((typeof(shifttimes.Sunday) == 'undefined') || (shifttimes.Sunday == '')){
                                    shift_list = []
                                }
                                else{
                                    shift_list = shifttimes.Sunday
                                }
                                console.log(shift_list)
                                shift_list.push({hours: shift_hours, unassigned: numemployees, assigned: 0, assignedworkers: ''})
                                shifttimes.Sunday = shift_list;
                            }
                            else if(selected[i] == 'Monday'){
                                if((typeof(shifttimes.Monday) == 'undefined') || (shifttimes.Monday == '')){
                                    shifttimes.Monday = []
                                }
                                shifttimes.Monday.push({hours: shift_hours, unassigned: numemployees, assigned: 0, assignedworkers: ''});
                            }
                            else if(selected[i] == 'Tuesday'){
                                if((typeof(shifttimes.Tuesday) == 'undefined') || (shifttimes.Tuesday == '')){
                                    shifttimes.Tuesday = []
                                }
                                shifttimes.Tuesday.push({hours: shift_hours, unassigned: numemployees, assigned: 0, assignedworkers: ''});
                            }
                            else if(selected[i] == 'Wednesday'){
                                if((typeof(shifttimes.Wednesday) == 'undefined') || (shifttimes.Wednesday == '')){
                                    shifttimes.Wednesday = []
                                }
                                shifttimes.Wednesday.push({hours: shift_hours, unassigned: numemployees, assigned: 0, assignedworkers: ''});
                            }
                            else if(selected[i] == 'Thursday'){
                                if((typeof(shifttimes.Thursday) == 'undefined') || (shifttimes.Thursday == '')){
                                    shifttimes.Thursday = []
                                }
                                shifttimes.Thursday.push({hours: shift_hours, unassigned: numemployees, assigned: 0, assignedworkers: ''});
                            }
                            else if(selected[i] == 'Friday'){
                                if((typeof(shifttimes.Friday) == 'undefined') || (shifttimes.Friday == '')){
                                    shifttimes.Friday = []
                                }
                                shifttimes.Friday.push({hours: shift_hours, unassigned: numemployees, assigned: 0, assignedworkers: ''});
                            }
                            else if(selected[i] == 'Saturday'){
                                if((typeof(shifttimes.Saturday) == 'undefined') || (shifttimes.Saturday == '')){
                                    shifttimes.Saturday = []
                                }
                                shifttimes.Saturday.push({hours: shift_hours, unassigned: numemployees, assigned: 0, assignedworkers: ''});
                            }
                        }
                    });
                    $('#hourslist').empty();
                    $('#repeatboxes').empty();
                    myFirebaseRef.child('shifttimes').update(shifttimes);
                }
                for(i=0;i<$(".cal-item-clickable").length;i++){
                    if($($(".cal-item-clickable")[i]).attr('class').indexOf("disabled") == -1){
                        $($(".cal-item-clickable")[i]).addClass("disabled");
                    }
                }
            }
            var isMouseDown = false;
            $("#calendar td")
                .mousedown(function () {
                    if(!($(this).attr('class').indexOf("tlabel") >= 0) || !($(this).attr('class').indexOf("extra-disabled") >= 0)){
                        isMouseDown = true;
                        $(this).toggleClass("disabled");
                        return false; // prevent text selection
                    }
                })
                .mouseover(function () {
                    if (isMouseDown) {
                        if(!($(this).attr('class').indexOf("tlabel") >= 0) || !($(this).attr('class').indexOf("extra-disabled") >= 0)){
                            $(this).toggleClass("disabled");
                        }
                    }
                })
                .bind("selectstart", function () {
                    if(!($(this).attr('class').indexOf("tlabel") >= 0) || !($(this).attr('class').indexOf("extra-disabled") >= 0)){
                        return false; // prevent text selection in IE
                    }
                });
                $(document).mouseup(function () {
                    // if(!($(this).attr('class').indexOf("tlabel") >= 0)){
                        isMouseDown = false;
                    // }
                });
            });
    </script>
</html>